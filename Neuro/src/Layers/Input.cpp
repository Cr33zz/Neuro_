#include "Layers/Input.h"

namespace Neuro
{
	//////////////////////////////////////////////////////////////////////////
	Input::Input(const Shape& inputShape, const string& name)
		: LayerBase(inputShape, inputShape, nullptr, name)
	{
	}

	//////////////////////////////////////////////////////////////////////////
	Input::Input()
	{
	}

	//////////////////////////////////////////////////////////////////////////
	const char* Input::ClassName() const
	{
		return "Input";
	}

	//////////////////////////////////////////////////////////////////////////
	LayerBase* Input::GetCloneInstance() const
	{
		return new Input();
	}

	//////////////////////////////////////////////////////////////////////////
	void Input::FeedForwardInternal()
	{
		// output is already of proper shape thanks to LayerBase.FeedForward
		m_Inputs[0]->CopyTo(m_Output);
	}

	//////////////////////////////////////////////////////////////////////////
	void Input::BackPropInternal(Tensor& outputGradient)
	{
		m_InputsGradient[0] = outputGradient;
	}
}
